<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learn Ba (ب) - Fun Arabic Lesson for Kids</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome for icons (optional, using emojis mostly) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* Custom styles for the page */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f9ff; /* Light blue background */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            max-width: 900px;
            width: 100%;
            background-color: #ffffff;
            border-radius: 2rem; /* More rounded */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 30px;
        }
        .section-title {
            color: #1e40af; /* Darker blue */
            font-size: 2.5rem;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .card {
            background-color: #e0f2fe; /* Lighter blue */
            border-radius: 1.5rem;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.12);
        }
        .letter-display {
            font-size: 8rem; /* Very large letter */
            color: #ef4444; /* Red */
            font-weight: bold;
            line-height: 1;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.2);
        }
        .harakat-display {
            font-size: 6rem;
            color: #10b981; /* Green */
            font-weight: bold;
            line-height: 1;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.15);
        }
        .emoji {
            font-size: 4rem;
            margin-bottom: 10px;
            animation: bounceIn 0.8s ease-out;
        }
        .play-button {
            background-color: #3b82f6; /* Blue */
            color: white;
            padding: 12px 25px;
            border-radius: 9999px; /* Pill shape */
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .play-button:hover {
            background-color: #2563eb; /* Darker blue */
            transform: scale(1.05);
        }
        .play-button:active {
            transform: scale(0.98);
        }

        /* Canvas for tracing */
        #tracingCanvas {
            border: 3px dashed #93c5fd; /* Light blue dashed border */
            background-color: #ffffff;
            cursor: crosshair;
            touch-action: none; /* Prevent scrolling on touch */
            border-radius: 1rem;
            margin-top: 20px;
        }
        .canvas-controls button {
            background-color: #f97316; /* Orange */
            color: white;
            padding: 10px 20px;
            border-radius: 0.75rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .canvas-controls button:hover {
            background-color: #ea580c; /* Darker orange */
        }

        /* Activity specific styles */
        .activity-options button {
            background-color: #a78bfa; /* Purple */
            color: white;
            padding: 15px 30px;
            border-radius: 1.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .activity-options button:hover {
            background-color: #8b5cf6; /* Darker purple */
            transform: scale(1.05);
        }
        .activity-options button.correct {
            background-color: #22c55e; /* Green for correct */
            animation: pulse 0.5s infinite alternate;
        }
        .activity-options button.incorrect {
            background-color: #ef4444; /* Red for incorrect */
            animation: shake 0.3s;
        }
        .feedback-message {
            margin-top: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #333;
        }

        /* Keyframe Animations */
        @keyframes bounceIn {
            0% { transform: scale(0.3); opacity: 0; }
            50% { transform: scale(1.1); opacity: 1; }
            70% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            20%, 60% { transform: translateX(-5px); }
            40%, 80% { transform: translateX(5px); }
        }
    </style>
</head>
<body dir="rtl"> <!-- Set direction to right-to-left for Arabic -->
    <div class="container">
        <!-- Welcome Section -->
        <div class="card bg-gradient-to-r from-purple-400 to-pink-500 text-white p-6 rounded-2xl shadow-lg">
            <h1 class="text-4xl font-extrabold mb-4 text-center">أهلاً وسهلاً يا أبطال! 👋</h1>
            <p class="text-xl text-center">هيا نتعلم حرف الباء (ب) وأصواته الجميلة!</p>
        </div>

        <!-- Letter Ba Introduction -->
        <div class="card">
            <h2 class="section-title">حرف الباء (ب)</h2>
            <div class="letter-display">ب</div>
            <p class="text-2xl font-semibold text-gray-700 mt-2">هذا هو حرف الباء!</p>
            <button class="play-button mt-4" onclick="playAudio('ba_letter_sound')">
                <i class="fas fa-volume-up"></i> اسمع الصوت
            </button>
            <div class="emoji mt-5">🦆</div>
            <p class="text-xl font-medium text-gray-800">بطة (Baṭṭah) - Duck</p>
        </div>

        <!-- Harakat Section -->
        <div class="card">
            <h2 class="section-title">أصوات حرف الباء (الحركات)</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mt-6">
                <!-- Ba (Fatha) -->
                <div class="card bg-yellow-100">
                    <p class="harakat-display">بَ</p>
                    <p class="text-xl font-semibold text-gray-700">بَ (Ba) - فتحة</p>
                    <button class="play-button mt-3 bg-yellow-500 hover:bg-yellow-600" onclick="playAudio('ba_fatha_sound')">
                        <i class="fas fa-volume-up"></i> اسمع
                    </button>
                    <div class="emoji mt-4">🚪</div>
                    <p class="text-lg font-medium text-gray-800">بَاب (Bāb) - Door</p>
                </div>
                <!-- Bi (Kasra) -->
                <div class="card bg-green-100">
                    <p class="harakat-display">بِ</p>
                    <p class="text-xl font-semibold text-gray-700">بِ (Bi) - كسرة</p>
                    <button class="play-button mt-3 bg-green-500 hover:bg-green-600" onclick="playAudio('bi_kasra_sound')">
                        <i class="fas fa-volume-up"></i> اسمع
                    </button>
                    <div class="emoji mt-4">🐧</div>
                    <p class="text-lg font-medium text-gray-800">بِطْرِيق (Biṭrīq) - Penguin</p>
                </div>
                <!-- Bu (Damma) -->
                <div class="card bg-red-100">
                    <p class="harakat-display">بُ</p>
                    <p class="text-xl font-semibold text-gray-700">بُ (Bu) - ضمة</p>
                    <button class="play-button mt-3 bg-red-500 hover:bg-red-600" onclick="playAudio('bu_damma_sound')">
                        <i class="fas fa-volume-up"></i> اسمع
                    </button>
                    <div class="emoji mt-4">🍊</div>
                    <p class="text-lg font-medium text-gray-800">بُرْتُقَال (Burtuqāl) - Orange</p>
                </div>
                <!-- B (Sukoon) -->
                <div class="card bg-blue-100">
                    <p class="harakat-display">بْ</p>
                    <p class="text-xl font-semibold text-gray-700">بْ (B) - سكون</p>
                    <button class="play-button mt-3 bg-blue-500 hover:bg-blue-600" onclick="playAudio('b_sukoon_sound')">
                        <i class="fas fa-volume-up"></i> اسمع
                    </button>
                    <div class="emoji mt-4">👨‍👧‍👦</div>
                    <p class="text-lg font-medium text-gray-800">أَبْ (Ab) - Father</p>
                </div>
            </div>
        </div>

        <!-- Activity 1: Tracing the Letter -->
        <div class="card bg-purple-100">
            <h2 class="section-title">النشاط الأول: تتبع حرف الباء</h2>
            <p class="text-xl text-gray-700 mb-4">تتبع حرف الباء بإصبعك أو الماوس!</p>
            <canvas id="tracingCanvas" width="400" height="200" class="w-full max-w-md mx-auto"></canvas>
            <div class="canvas-controls mt-4 flex justify-center gap-4">
                <button onclick="clearCanvas()">امسح</button>
            </div>
        </div>

        <!-- Activity 2: Sound Matching Game -->
        <div class="card bg-pink-100">
            <h2 class="section-title">النشاط الثاني: لعبة مطابقة الصوت</h2>
            <p class="text-xl text-gray-700 mb-4">اضغط على الصورة، ثم اختر الصوت الصحيح!</p>
            <div class="flex flex-col items-center gap-6">
                <div id="soundMatchImage" class="emoji text-6xl cursor-pointer" onclick="playCurrentWordSound()"></div>
                <p id="soundMatchQuestion" class="text-2xl font-semibold text-gray-800">ما هو الصوت الأول لهذه الكلمة؟</p>
                <div class="activity-options grid grid-cols-2 gap-4">
                    <button id="optionBa" onclick="checkSoundMatch('ba_fatha_sound')">بَ</button>
                    <button id="optionBi" onclick="checkSoundMatch('bi_kasra_sound')">بِ</button>
                    <button id="optionBu" onclick="checkSoundMatch('bu_damma_sound')">بُ</button>
                    <button id="optionB" onclick="checkSoundMatch('b_sukoon_sound')">بْ</button>
                </div>
                <p id="soundMatchFeedback" class="feedback-message"></p>
                <button class="play-button bg-indigo-500 hover:bg-indigo-600 mt-4" onclick="nextSoundMatchQuestion()">
                    <i class="fas fa-arrow-right"></i> سؤال تالي
                </button>
            </div>
        </div>

        <!-- Activity 3: Word Recognition (Simple) -->
        <div class="card bg-teal-100">
            <h2 class="section-title">النشاط الثالث: تعرف على الكلمة</h2>
            <p class="text-xl text-gray-700 mb-4">شاهد الصورة واختر الحرف المناسب!</p>
            <div class="flex flex-col items-center gap-6">
                <div id="wordRecognitionImage" class="emoji text-6xl"></div>
                <p id="wordRecognitionQuestion" class="text-2xl font-semibold text-gray-800">تبدأ هذه الكلمة بصوت:</p>
                <div class="activity-options grid grid-cols-3 gap-4">
                    <button id="wrOptionBa" onclick="checkWordRecognition('ba_fatha_sound')">بَ</button>
                    <button id="wrOptionBi" onclick="checkWordRecognition('bi_kasra_sound')">بِ</button>
                    <button id="wrOptionBu" onclick="checkWordRecognition('bu_damma_sound')">بُ</button>
                </div>
                <p id="wordRecognitionFeedback" class="feedback-message"></p>
                <button class="play-button bg-cyan-500 hover:bg-cyan-600 mt-4" onclick="nextWordRecognitionQuestion()">
                    <i class="fas fa-arrow-right"></i> سؤال تالي
                </button>
            </div>
        </div>

        <!-- Conclusion -->
        <div class="card bg-gradient-to-r from-blue-400 to-green-500 text-white p-6 rounded-2xl shadow-lg">
            <h2 class="text-3xl font-extrabold mb-4 text-center">أحسنت يا بطل! 🎉</h2>
            <p class="text-xl text-center">لقد تعلمت حرف الباء وأصواته! استمر في المراجعة واللعب!</p>
        </div>
    </div>

    <script>
        // --- Audio Setup ---
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const audioBuffers = {};

        // Function to generate simple sine wave sounds for demonstration
        // In a real app for kids, you'd use pre-recorded audio files.
        // For this example, we'll simulate sounds.
        async function createAndStoreAudio(name, frequency, duration, type = 'sine') {
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.type = type;
            oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime);
            gainNode.gain.setValueAtTime(1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + duration);

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            const buffer = audioContext.createBuffer(1, audioContext.sampleRate * duration, audioContext.sampleRate);
            const channelData = buffer.getChannelData(0);

            // Simulate the sound into the buffer (this is a simplified way)
            for (let i = 0; i < channelData.length; i++) {
                channelData[i] = Math.sin(2 * Math.PI * frequency * (i / audioContext.sampleRate));
            }

            audioBuffers[name] = buffer;
        }

        // Preload/create sounds when the window loads
        window.onload = async function() {
            // Note: For actual LKG teaching, you would replace these with real recorded sounds
            // For example: new Audio('path/to/ba_letter.mp3');
            // Here, we're simulating basic tones.
            await createAndStoreAudio('ba_letter_sound', 440, 0.8); // A4
            await createAndStoreAudio('ba_fatha_sound', 523, 0.6); // C5 (Ba)
            await createAndStoreAudio('bi_kasra_sound', 392, 0.6); // G4 (Bi)
            await createAndStoreAudio('bu_damma_sound', 659, 0.6); // E5 (Bu)
            await createAndStoreAudio('b_sukoon_sound', 261, 0.4, 'sawtooth'); // C4 (B - short, stopped)

            // Sounds for activities
            await createAndStoreAudio('battah_sound', 523, 1.0); // C5 (Duck)
            await createAndStoreAudio('bitreeq_sound', 392, 1.0); // G4 (Penguin)
            await createAndStoreAudio('burtuqal_sound', 659, 1.0); // E5 (Orange)
            await createAndStoreAudio('ab_sound', 261, 0.8); // C4 (Father)

            // Initialize activities after sounds are ready
            nextSoundMatchQuestion();
            nextWordRecognitionQuestion();
        };

        function playAudio(soundName) {
            if (audioBuffers[soundName]) {
                const source = audioContext.createBufferSource();
                source.buffer = audioBuffers[soundName];
                source.connect(audioContext.destination);
                source.start(0);
            } else {
                console.warn(`Audio for ${soundName} not found.`);
            }
        }


        // --- Tracing Canvas Activity ---
        const canvas = document.getElementById('tracingCanvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;

        // Set canvas size dynamically for responsiveness
        function resizeCanvas() {
            const parent = canvas.parentElement;
            canvas.width = parent.clientWidth > 400 ? 400 : parent.clientWidth - 40; // Max 400px, or parent width minus padding
            canvas.height = canvas.width * 0.5; // Maintain aspect ratio
            drawLetterOutline(); // Redraw outline on resize
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas(); // Initial resize

        function drawLetterOutline() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear existing
            ctx.strokeStyle = '#93c5fd'; // Light blue
            ctx.lineWidth = 5;
            ctx.setLineDash([10, 10]); // Dashed line

            const scaleX = canvas.width / 400;
            const scaleY = canvas.height / 200;

            ctx.beginPath();
            // Draw a simplified 'ب' outline (Arabic letter Ba)
            // This is a very basic representation, for LKG tracing.
            ctx.moveTo(50 * scaleX, 150 * scaleY);
            ctx.lineTo(350 * scaleX, 150 * scaleY);
            ctx.arc(350 * scaleX, 100 * scaleY, 50 * scaleY, Math.PI / 2, -Math.PI / 2, true);
            ctx.lineTo(50 * scaleX, 50 * scaleY);
            ctx.arc(50 * scaleX, 100 * scaleY, 50 * scaleY, -Math.PI / 2, Math.PI / 2, true);
            ctx.closePath();
            ctx.stroke();

            // Draw the dot
            ctx.beginPath();
            ctx.arc(200 * scaleX, 165 * scaleY, 8 * scaleY, 0, Math.PI * 2);
            ctx.fillStyle = '#93c5fd';
            ctx.fill();

            ctx.setLineDash([]); // Reset line dash for drawing
        }

        function startDrawing(e) {
            isDrawing = true;
            draw(e); // Draw a dot immediately
        }

        function stopDrawing() {
            isDrawing = false;
            ctx.beginPath(); // Reset path
        }

        function draw(e) {
            if (!isDrawing) return;

            const rect = canvas.getBoundingClientRect();
            let clientX, clientY;

            if (e.touches) { // For touch events
                clientX = e.touches[0].clientX;
                clientY = e.touches[0].clientY;
            } else { // For mouse events
                clientX = e.clientX;
                clientY = e.clientY;
            }

            const x = clientX - rect.left;
            const y = clientY - rect.top;

            ctx.lineWidth = 10;
            ctx.lineCap = 'round';
            ctx.strokeStyle = '#3b82f6'; // Blue drawing color

            ctx.lineTo(x, y);
            ctx.stroke();
            ctx.beginPath();
            ctx.moveTo(x, y);
        }

        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing); // Stop drawing if mouse leaves canvas
        canvas.addEventListener('mousemove', draw);

        // Touch events
        canvas.addEventListener('touchstart', startDrawing);
        canvas.addEventListener('touchend', stopDrawing);
        canvas.addEventListener('touchcancel', stopDrawing);
        canvas.addEventListener('touchmove', function(e) {
            e.preventDefault(); // Prevent scrolling when drawing on touch
            draw(e);
        }, { passive: false }); // Use passive: false for preventDefault

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawLetterOutline(); // Redraw the outline
        }

        // --- Activity 2: Sound Matching Game ---
        const soundMatchData = [
            { emoji: '🦆', wordSound: 'battah_sound', correctHarakat: 'ba_fatha_sound' },
            { emoji: '🐧', wordSound: 'bitreeq_sound', correctHarakat: 'bi_kasra_sound' },
            { emoji: '🍊', wordSound: 'burtuqal_sound', correctHarakat: 'bu_damma_sound' },
            // Adding one for Sukoon, though it's harder for LKG to identify initial sound
            { emoji: '👨‍👧‍👦', wordSound: 'ab_sound', correctHarakat: 'b_sukoon_sound' }
        ];
        let currentSoundMatchIndex = 0;

        const soundMatchImage = document.getElementById('soundMatchImage');
        const soundMatchFeedback = document.getElementById('soundMatchFeedback');
        const soundMatchOptions = [
            document.getElementById('optionBa'),
            document.getElementById('optionBi'),
            document.getElementById('optionBu'),
            document.getElementById('optionB')
        ];

        function nextSoundMatchQuestion() {
            currentSoundMatchIndex = (currentSoundMatchIndex + 1) % soundMatchData.length;
            const data = soundMatchData[currentSoundMatchIndex];
            soundMatchImage.textContent = data.emoji;
            soundMatchFeedback.textContent = '';
            soundMatchOptions.forEach(btn => {
                btn.classList.remove('correct', 'incorrect');
                btn.disabled = false;
            });
            playCurrentWordSound(); // Play sound automatically when new question appears
        }

        function playCurrentWordSound() {
            playAudio(soundMatchData[currentSoundMatchIndex].wordSound);
        }

        function checkSoundMatch(selectedHarakatSound) {
            const correctHarakat = soundMatchData[currentSoundMatchIndex].correctHarakat;
            soundMatchOptions.forEach(btn => btn.disabled = true); // Disable buttons after selection

            if (selectedHarakatSound === correctHarakat) {
                soundMatchFeedback.textContent = 'أحسنت! هذا صحيح! 🎉';
                document.getElementById(event.target.id).classList.add('correct');
            } else {
                soundMatchFeedback.textContent = 'حاول مرة أخرى. 🤔';
                document.getElementById(event.target.id).classList.add('incorrect');
            }
        }

        // --- Activity 3: Word Recognition (Simple) ---
        const wordRecognitionData = [
            { emoji: '🦆', correctHarakat: 'ba_fatha_sound' },
            { emoji: '🐧', correctHarakat: 'bi_kasra_sound' },
            { emoji: '🍊', correctHarakat: 'bu_damma_sound' }
            // Sukoon is generally not an initial sound, so excluding it here for simplicity for LKG
        ];
        let currentWordRecognitionIndex = 0;

        const wordRecognitionImage = document.getElementById('wordRecognitionImage');
        const wordRecognitionFeedback = document.getElementById('wordRecognitionFeedback');
        const wordRecognitionOptions = [
            document.getElementById('wrOptionBa'),
            document.getElementById('wrOptionBi'),
            document.getElementById('wrOptionBu')
        ];

        function nextWordRecognitionQuestion() {
            currentWordRecognitionIndex = (currentWordRecognitionIndex + 1) % wordRecognitionData.length;
            const data = wordRecognitionData[currentWordRecognitionIndex];
            wordRecognitionImage.textContent = data.emoji;
            wordRecognitionFeedback.textContent = '';
            wordRecognitionOptions.forEach(btn => {
                btn.classList.remove('correct', 'incorrect');
                btn.disabled = false;
            });
            // Play the word sound for context
            playAudio(soundMatchData.find(item => item.emoji === data.emoji).wordSound);
        }

        function checkWordRecognition(selectedHarakatSound) {
            const correctHarakat = wordRecognitionData[currentWordRecognitionIndex].correctHarakat;
            wordRecognitionOptions.forEach(btn => btn.disabled = true); // Disable buttons after selection

            if (selectedHarakatSound === correctHarakat) {
                wordRecognitionFeedback.textContent = 'ممتاز! هذا صحيح! 🥳';
                document.getElementById(event.target.id).classList.add('correct');
            } else {
                wordRecognitionFeedback.textContent = 'أوه لا! حاول مجدداً. 🧐';
                document.getElementById(event.target.id).classList.add('incorrect');
            }
        }
    </script>
</body>
</html>
